#define GAMMATABLE_SIZE 512
static const float gammatable[] = {0, 0.0252344, 0.0496693, 
0.068934, 0.0847167, 0.0983301, 0.110432, 0.121406, 
0.131499, 0.14088, 0.149671, 0.157963, 0.165825, 0.173314, 
0.180474, 0.187342, 0.193947, 0.200315, 0.206469, 0.212426, 
0.218203, 0.223814, 0.229271, 0.234585, 0.239766, 0.244823, 
0.249763, 0.254593, 0.25932, 0.26395, 0.268487, 0.272937, 
0.277304, 0.281592, 0.285805, 0.289946, 0.294019, 0.298027, 
0.301971, 0.305856, 0.309683, 0.313454, 0.317172, 0.320839, 
0.324456, 0.328026, 0.33155, 0.335029, 0.338466, 0.341861, 
0.345216, 0.348532, 0.35181, 0.355051, 0.358257, 0.361429, 
0.364567, 0.367673, 0.370747, 0.37379, 0.376804, 0.379788, 
0.382744, 0.385672, 0.388573, 0.391448, 0.394297, 0.397121, 
0.39992, 0.402696, 0.405448, 0.408178, 0.410885, 0.41357, 
0.416234, 0.418877, 0.421499, 0.424102, 0.426685, 0.429248, 
0.431793, 0.434319, 0.436827, 0.439317, 0.44179, 0.444246, 
0.446685, 0.449107, 0.451514, 0.453904, 0.456279, 0.458638, 
0.460982, 0.463312, 0.465627, 0.467927, 0.470214, 0.472487, 
0.474746, 0.476991, 0.479224, 0.481443, 0.48365, 0.485844, 
0.488026, 0.490195, 0.492353, 0.494499, 0.496633, 0.498755, 
0.500866, 0.502966, 0.505055, 0.507133, 0.509201, 0.511258, 
0.513304, 0.51534, 0.517366, 0.519383, 0.521389, 0.523385, 
0.525372, 0.52735, 0.529318, 0.531276, 0.533226, 0.535167, 
0.537099, 0.539022, 0.540936, 0.542842, 0.544739, 0.546628, 
0.548509, 0.550381, 0.552246, 0.554102, 0.555951, 0.557792, 
0.559625, 0.56145, 0.563268, 0.565078, 0.566882, 0.568677, 
0.570466, 0.572247, 0.574022, 0.575789, 0.57755, 0.579303, 
0.58105, 0.582791, 0.584524, 0.586251, 0.587972, 0.589686, 
0.591394, 0.593095, 0.59479, 0.596479, 0.598162, 0.599839, 
0.60151, 0.603175, 0.604834, 0.606488, 0.608135, 0.609777, 
0.611413, 0.613044, 0.614669, 0.616288, 0.617903, 0.619511, 
0.621114, 0.622712, 0.624305, 0.625893, 0.627475, 0.629052, 
0.630625, 0.632192, 0.633754, 0.635311, 0.636863, 0.638411, 
0.639953, 0.641491, 0.643024, 0.644553, 0.646077, 0.647596, 
0.64911, 0.65062, 0.652126, 0.653627, 0.655123, 0.656616, 
0.658103, 0.659587, 0.661066, 0.662541, 0.664012, 0.665478, 
0.66694, 0.668398, 0.669853, 0.671303, 0.672749, 0.674191, 
0.675628, 0.677062, 0.678493, 0.679919, 0.681341, 0.68276, 
0.684174, 0.685585, 0.686992, 0.688396, 0.689795, 0.691192, 
0.692584, 0.693973, 0.695358, 0.69674, 0.698118, 0.699492, 
0.700863, 0.702231, 0.703595, 0.704956, 0.706313, 0.707667, 
0.709018, 0.710365, 0.711709, 0.713049, 0.714387, 0.715721, 
0.717052, 0.718379, 0.719704, 0.721025, 0.722343, 0.723659, 
0.724971, 0.726279, 0.727585, 0.728888, 0.730188, 0.731485, 
0.732778, 0.734069, 0.735357, 0.736642, 0.737924, 0.739203, 
0.740479, 0.741753, 0.743023, 0.744291, 0.745556, 0.746818, 
0.748077, 0.749334, 0.750588, 0.751839, 0.753087, 0.754333, 
0.755576, 0.756816, 0.758054, 0.759289, 0.760522, 0.761751, 
0.762979, 0.764203, 0.765426, 0.766645, 0.767862, 0.769077, 
0.770289, 0.771498, 0.772705, 0.77391, 0.775112, 0.776312, 
0.777509, 0.778704, 0.779897, 0.781087, 0.782275, 0.78346, 
0.784643, 0.785824, 0.787003, 0.788179, 0.789353, 0.790524, 
0.791693, 0.792861, 0.794025, 0.795188, 0.796348, 0.797506, 
0.798662, 0.799816, 0.800968, 0.802117, 0.803264, 0.804409, 
0.805552, 0.806693, 0.807832, 0.808969, 0.810103, 0.811236, 
0.812366, 0.813495, 0.814621, 0.815745, 0.816867, 0.817988, 
0.819106, 0.820222, 0.821336, 0.822448, 0.823559, 0.824667, 
0.825773, 0.826878, 0.82798, 0.829081, 0.83018, 0.831276, 
0.832371, 0.833464, 0.834555, 0.835644, 0.836732, 0.837817, 
0.838901, 0.839983, 0.841063, 0.842141, 0.843217, 0.844292, 
0.845364, 0.846435, 0.847505, 0.848572, 0.849638, 0.850702, 
0.851764, 0.852824, 0.853883, 0.85494, 0.855995, 0.857049, 
0.8581, 0.859151, 0.860199, 0.861246, 0.862291, 0.863334, 
0.864376, 0.865416, 0.866455, 0.867492, 0.868527, 0.86956, 
0.870592, 0.871623, 0.872652, 0.873679, 0.874704, 0.875728, 
0.876751, 0.877772, 0.878791, 0.879809, 0.880825, 0.88184, 
0.882853, 0.883864, 0.884874, 0.885883, 0.88689, 0.887896, 
0.8889, 0.889902, 0.890903, 0.891903, 0.892901, 0.893898, 
0.894893, 0.895886, 0.896879, 0.89787, 0.898859, 0.899847, 
0.900833, 0.901819, 0.902802, 0.903784, 0.904765, 0.905745, 
0.906723, 0.907699, 0.908675, 0.909649, 0.910621, 0.911592, 
0.912562, 0.913531, 0.914498, 0.915463, 0.916428, 0.917391, 
0.918353, 0.919313, 0.920272, 0.92123, 0.922186, 0.923141, 
0.924095, 0.925048, 0.925999, 0.926949, 0.927897, 0.928845, 
0.929791, 0.930736, 0.931679, 0.932622, 0.933563, 0.934502, 
0.935441, 0.936378, 0.937314, 0.938249, 0.939183, 0.940115, 
0.941046, 0.941976, 0.942905, 0.943832, 0.944759, 0.945684, 
0.946608, 0.94753, 0.948452, 0.949372, 0.950291, 0.951209, 
0.952126, 0.953042, 0.953956, 0.95487, 0.955782, 0.956693, 
0.957603, 0.958512, 0.959419, 0.960326, 0.961231, 0.962135, 
0.963038, 0.96394, 0.964841, 0.965741, 0.966639, 0.967537, 
0.968433, 0.969329, 0.970223, 0.971116, 0.972008, 0.972899, 
0.973789, 0.974678, 0.975565, 0.976452, 0.977338, 0.978222, 
0.979106, 0.979988, 0.980869, 0.98175, 0.982629, 0.983507, 
0.984384, 0.985261, 0.986136, 0.98701, 0.987883, 0.988755, 
0.989626, 0.990496, 0.991365, 0.992233, 0.9931, 0.993966, 
0.994831, 0.995695, 0.996558, 0.99742, 0.998281, 0.999141, 
};static const float ungammatable[] = {0, 0.000151171, 
0.000302341, 0.000453512, 0.000604683, 0.000755853, 
0.000907024, 0.00105819, 0.00120937, 0.00136054, 
0.00151171, 0.00166288, 0.00181405, 0.00196522, 0.00211639, 
0.00226756, 0.00241873, 0.0025699, 0.00272107, 0.00287224, 
0.00302341, 0.00317552, 0.00333276, 0.00349446, 0.00366063, 
0.00383133, 0.00400659, 0.00418644, 0.0043709, 0.00456003, 
0.00475384, 0.00495238, 0.00515567, 0.00536375, 0.00557664, 
0.00579438, 0.00601701, 0.00624454, 0.00647702, 0.00671447, 
0.00695692, 0.00720441, 0.00745695, 0.00771458, 0.00797734, 
0.00824524, 0.00851831, 0.00879659, 0.0090801, 0.00936888, 
0.00966294, 0.00996231, 0.010267, 0.0105771, 0.0108926, 
0.0112135, 0.0115398, 0.0118717, 0.012209, 0.0125518, 
0.0129002, 0.0132542, 0.0136138, 0.013979, 0.0143499, 
0.0147264, 0.0151087, 0.0154966, 0.0158903, 0.0162898, 
0.0166951, 0.0171062, 0.0175232, 0.017946, 0.0183747, 
0.0188093, 0.0192499, 0.0196964, 0.0201489, 0.0206075, 
0.021072, 0.0215426, 0.0220193, 0.0225021, 0.022991, 
0.023486, 0.0239872, 0.0244946, 0.0250082, 0.025528, 
0.0260541, 0.0265864, 0.027125, 0.02767, 0.0282212, 
0.0287788, 0.0293428, 0.0299132, 0.0304901, 0.0310733, 
0.031663, 0.0322592, 0.0328619, 0.0334711, 0.0340868, 
0.0347091, 0.035338, 0.0359734, 0.0366155, 0.0372642, 
0.0379196, 0.0385817, 0.0392504, 0.0399258, 0.040608, 
0.041297, 0.0419927, 0.0426952, 0.0434045, 0.0441206, 
0.0448436, 0.0455734, 0.0463102, 0.0470538, 0.0478043, 
0.0485618, 0.0493263, 0.0500977, 0.0508761, 0.0516615, 
0.0524539, 0.0532534, 0.05406, 0.0548736, 0.0556944, 
0.0565222, 0.0573572, 0.0581993, 0.0590486, 0.0599051, 
0.0607688, 0.0616397, 0.0625179, 0.0634033, 0.0642959, 
0.0651959, 0.0661032, 0.0670178, 0.0679397, 0.068869, 
0.0698057, 0.0707497, 0.0717012, 0.0726601, 0.0736264, 
0.0746002, 0.0755814, 0.0765701, 0.0775664, 0.0785701, 
0.0795814, 0.0806003, 0.0816267, 0.0826607, 0.0837023, 
0.0847515, 0.0858084, 0.0868729, 0.087945, 0.0890249, 
0.0901124, 0.0912077, 0.0923106, 0.0934213, 0.0945398, 
0.0956661, 0.0968001, 0.0979419, 0.0990916, 0.100249, 
0.101414, 0.102588, 0.103769, 0.104958, 0.106155, 0.107359, 
0.108572, 0.109793, 0.111021, 0.112258, 0.113503, 0.114755, 
0.116016, 0.117285, 0.118562, 0.119847, 0.121139, 0.122441, 
0.12375, 0.125067, 0.126392, 0.127726, 0.129068, 0.130418, 
0.131776, 0.133142, 0.134517, 0.1359, 0.137291, 0.13869, 
0.140098, 0.141514, 0.142938, 0.144371, 0.145812, 0.147261, 
0.148719, 0.150185, 0.151659, 0.153142, 0.154633, 0.156133, 
0.157641, 0.159158, 0.160683, 0.162216, 0.163758, 0.165309, 
0.166868, 0.168436, 0.170012, 0.171597, 0.17319, 0.174792, 
0.176403, 0.178022, 0.17965, 0.181286, 0.182932, 0.184586, 
0.186248, 0.187919, 0.189599, 0.191288, 0.192985, 0.194692, 
0.196407, 0.19813, 0.199863, 0.201604, 0.203354, 0.205113, 
0.206881, 0.208658, 0.210443, 0.212238, 0.214041, 0.215853, 
0.217675, 0.219505, 0.221344, 0.223192, 0.225049, 0.226915, 
0.228789, 0.230673, 0.232566, 0.234468, 0.236379, 0.238299, 
0.240229, 0.242167, 0.244114, 0.246071, 0.248036, 0.250011, 
0.251995, 0.253988, 0.25599, 0.258001, 0.260021, 0.262051, 
0.26409, 0.266138, 0.268196, 0.270262, 0.272338, 0.274423, 
0.276518, 0.278621, 0.280734, 0.282857, 0.284988, 0.287129, 
0.28928, 0.29144, 0.293609, 0.295787, 0.297975, 0.300172, 
0.302379, 0.304595, 0.306821, 0.309056, 0.3113, 0.313554, 
0.315818, 0.318091, 0.320374, 0.322666, 0.324967, 0.327278, 
0.329599, 0.331929, 0.334269, 0.336619, 0.338978, 0.341346, 
0.343725, 0.346113, 0.34851, 0.350917, 0.353334, 0.355761, 
0.358197, 0.360643, 0.363099, 0.365564, 0.36804, 0.370525, 
0.373019, 0.375524, 0.378038, 0.380562, 0.383096, 0.385639, 
0.388193, 0.390756, 0.393329, 0.395912, 0.398505, 0.401108, 
0.403721, 0.406343, 0.408976, 0.411618, 0.41427, 0.416933, 
0.419605, 0.422287, 0.424979, 0.427681, 0.430393, 0.433116, 
0.435848, 0.43859, 0.441342, 0.444104, 0.446877, 0.449659, 
0.452452, 0.455254, 0.458067, 0.46089, 0.463722, 0.466565, 
0.469419, 0.472282, 0.475155, 0.478039, 0.480933, 0.483837, 
0.486751, 0.489676, 0.49261, 0.495555, 0.49851, 0.501476, 
0.504451, 0.507437, 0.510434, 0.51344, 0.516457, 0.519484, 
0.522522, 0.525569, 0.528628, 0.531696, 0.534775, 0.537864, 
0.540964, 0.544074, 0.547194, 0.550325, 0.553466, 0.556618, 
0.55978, 0.562953, 0.566136, 0.569329, 0.572533, 0.575748, 
0.578973, 0.582208, 0.585455, 0.588711, 0.591978, 0.595256, 
0.598544, 0.601843, 0.605152, 0.608472, 0.611803, 0.615144, 
0.618496, 0.621858, 0.625232, 0.628615, 0.63201, 0.635415, 
0.63883, 0.642257, 0.645694, 0.649142, 0.6526, 0.65607, 
0.65955, 0.66304, 0.666542, 0.670054, 0.673577, 0.677111, 
0.680656, 0.684211, 0.687777, 0.691354, 0.694942, 0.698541, 
0.70215, 0.705771, 0.709402, 0.713044, 0.716697, 0.720361, 
0.724036, 0.727722, 0.731419, 0.735126, 0.738845, 0.742574, 
0.746315, 0.750066, 0.753828, 0.757602, 0.761386, 0.765182, 
0.768988, 0.772805, 0.776634, 0.780473, 0.784324, 0.788185, 
0.792058, 0.795942, 0.799837, 0.803743, 0.80766, 0.811588, 
0.815527, 0.819477, 0.823439, 0.827412, 0.831396, 0.835391, 
0.839397, 0.843414, 0.847443, 0.851482, 0.855533, 0.859596, 
0.863669, 0.867754, 0.87185, 0.875957, 0.880075, 0.884205, 
0.888346, 0.892498, 0.896662, 0.900837, 0.905023, 0.90922, 
0.913429, 0.917649, 0.921881, 0.926124, 0.930378, 0.934644, 
0.938921, 0.943209, 0.947509, 0.95182, 0.956143, 0.960477, 
0.964823, 0.96918, 0.973548, 0.977928, 0.98232, 0.986722, 
0.991137, 0.995563, };